<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width">
  <title>Balato</title>
  <link href="style.css" rel="stylesheet" type="text/css" />
</head>

  <body>
    <div id="load">
      <h1>Balato</h1>
      <button id="playBtn">Play</button>
      <button id="options">Options</button>
      <button id="collectionsBtn">Collection</button>
    </div>
    <div id="board">
      <div>
        <div></div>
      </div>
      <div>
        <div>
          <button id="nextRoundBtn"></button>
          <button id="rerollBtn"></button>
        </div>
        <div id="center"></div>
      </div>
      <div>
        <div id="hand"></div>
        <div id="deck"></div>
      </div>
    </div>
    <div id="base">
      <div id="dashboard">
        <div style="display: flex;align-items: center;" id="blind">
          <p id="blindTitle">big blind</p>
          <p>score</p>
          <p id="blindReq">2,000,000,000</p>
          <p>to gain</p>
          <p id="blindReward">$4</p>
        </div>
        <div id="scre">
          <div>
            <p>round score</p>
            <p id="roundScore">1,000,000,000</p>
          </div>
          <div>
            <p>high card <span>lvl.2</span></p>
          </div>
          <div>
            <p id="chips">chip</p>
            <p>x</p>
            <p id="mult">mult</p>
          </div>
        </div>
        <div id="roundInfo">
              <div>
                <div>
                  <p>Hands</p>
                  <p id="hands">4</p>
                </div>
                <div>
                  <p>Discards</p>
                  <p id="discards"></p>
                </div>
              </div>
              <div>
                <p id="coin">500</p>
              </div>
              <div>
                <div>
                  <p>Ante</p>
                  <p><span id="ante"></span>/8</p>
                </div>
                <div>
                  <p>Round</p>
                  <p id="round"></p>
                </div>
              </div>
        </div>
      </div>
      <div id="buttonBar">
        <button>run info</button>
        <button>options</button>
        <div style="display: flex;align-items: center;"><p style="height:25px;">deck</p></div>
      </div>
      <div id="upperboard">
        <div id="jokers">
          <div>1abcagggdf</div>
          <div>2aabcgggadf</div>
          <div>3aabcgggadf</div>
          <div>4aabcgggadf</div>
          <div>5aabcgggadf</div>
          <div>6aabcgggadf</div>
          <div>7aabcgggadf</div>
          <div>8aabcgggadf</div>
        </div>
        <div id="consumables">
          <div>1abcagggdf</div>
          <div>2aabcgggadf</div>
          <div>3aabcgggadf</div>
          <div>4aabcgggadf</div>
          <div>5aabcgggadf</div>
        </div>
      </div>
        
      <div id="center">
        <div>1s</div>
        <div>2s</div>
        <div>3s</div>
        <div>4s</div>
        <div>5s</div>
        <div>6s</div>
        <div>7s</div>
        <div>8s</div>
        <div>9s</div>
      </div>
      <div id="playButtons">
        <button id="playHand">play</button>
        <button id="sortRank">rank</button>
        <button id="sortSuit">suit</button>
        <button id="discardHand">discard</button>
      </div>
      <div id="hand">
        <div>1s</div>
        <div>2s</div>
        <div>3s</div>
        <div>4s</div>
        <div>5s</div>
        <div>6s</div>
        <div>7s</div>
        <div>8s</div>
        <div>9s</div>
      </div>
    </div>
  </body>
  
  <style id="generalStyle">
    *{
      font-size: 25px;
      font-family: 'Courier New', Courier, monospace;
      margin: 0;
      contain: paint;
      text-align: center;
      vertical-align: middle;
          cursor: default;
          -webkit-touch-callout: none;
          -webkit-user-select: none;
          -khtml-user-select: none;
          -moz-user-select: none;
          -ms-user-select: none;
          user-select: none;
      overscroll-behavior: none;
    }
    p{
      width: 120px;
      //background-color: blue;
      height: 60px;
    }
  </style>
  <style id="baseAndDashboardStyle">
    #base{
      width: 100vw;
      height: 100vh;
      display: flex;
      flex-direction: column;
      
      scale: 0.95;
    }
    #base>div{
      width: 100vw;  
    }
      #dashboard,#buttonBar{
        display:flex;
        flex-direction: row;
      }
      #dashboard{
        background-color: lightpink;
        height: 25.25vh;
      }
        #dashboard>div{
          width: 30%;
          height: 100%;
          display: flex;
          flex-direction: column;
        }
  </style>
  <style id="dashboardBlindStyle">
          #blind{
            background-color: lightcyan;
          }
          #blind>*{
            width: 100%;
            font-size: 20px;
          }
          p#blindTitle{
            background-color: lightblue;
            height: 55px;
            font-size: 25px;
          }
          #blind>*:nth-child(2n){
            padding-top: 2px;
            height: 30px;
          }
          #blindReq{
            height: 50px;
            font-size: 20px; /*turn into js*/
            word-wrap: break-word;
            text-wrap: wrap;
          }
          #blindReward{
            height: 30px;
          }
  </style>
  <style id="dashboardScoreStyle">
        div#scre{
          width: 40%;
        }
          div#scre>*{
            width: 100%;
          }
          #scre>*:nth-child(1){
            height: 25%;
            background-color: slategray;
            display:flex;
            flex-direction: row;
            align-items: center;
          }
            #scre>*:nth-child(1)>*{
              font-size: 12px;
              word-wrap: break-word;
              text-wrap: wrap;
            }
            #scre>*:nth-child(1)>*:nth-child(1){
              height: 80%;
              width: 40%;
            }
            p#roundScore{
              height: 100%;
              width: 60%;
              font-size: 20px; /*turn into js*/
            }
          #scre>*:nth-child(2){
            height: 55%;
            background-color: lightgray;
            display: flex;
            flex-direction: row;
            align-items: center;
          }
          #scre>*:nth-child(2)>p{
            width: 100%;
          }
          #scre>*:nth-child(2)>p>span{
            width: 30%;
            font-size: 18px;
          }
          div#scre>*:nth-child(3){
            height: 32px;
            font-size: 33px;
            background-color: white;
            padding: 10px 0;
            display: flex;
            flex-direction: row;
          }
            #scre>*:nth-child(3)>p{
              height: 100%;
            }
            #scre>*:nth-child(3)>p:nth-child(2n-1){
              width: 45%;
            }
            #scre>*:nth-child(3)>p:nth-child(2){
              width: 10%;
            }
            p#chips{
              background-color: blue;
            }
            p#mult{
              background-color: red;
            }
  </style>
  <style id="buttonBarStyle">
    #buttonBar{
      background-color: lightcoral;
      justify-content: space-around;
      height: 8.75vh;
      align-items: center;
    }
      #buttonBar>*{
        width: 30vw;
        height: 7.25vh;
      }
      #buttonBar>*:nth-child(3){
        background-color: moccasin;
      }
      
      div#roundInfo{
      }
      div#roundInfo>div{
        width: 100%;
        height: calc(100%/3);
        display: flex;
        flex-direction: row;
      }
        div#roundInfo>div>div{
          width: 50%;
          height: 100%;
          display: flex;
          flex-direction: column;
        }
          div#roundInfo>div>div>*{
            width: 100%;
            height: 40%;
            font-size: 13px;
            padding-top: 6px;
          }
          div#roundInfo>div>div>*:nth-child(2){
            background-color: cyan;
            font-size: 21px;
          }
        #roundInfo>div:nth-child(2){
          display:flex;
          align-items: center;
          background-color: red;
        }
        #roundInfo>div:nth-child(2)>*{
          height: 26px;
        }
  </style>
  <style id="loadAndBoardStyle">
    #load{
      display: none;
      position: absolute;
      z-index: 10;
      bottom: 0;
      left: 2vw;
      
      color: white;
      
      background-color: rgba(0,0,0,0.8);
      width: 96vw;
      height: 77.5vh;
    }
    #board{
      z-index: 0;
      display: none;
    }
  </style>
  <style id="upperboard_Center_Hand_Style">
    #center,#hand,#jokers, #consumables{
      overflow-x: hidden;
      overflow-y: scroll;
      display: flex;
      flex-direction: row;
      flex-wrap: wrap;
      justify-content: space-evenly;
      align-items: center;
    }
    
    #upperboard{
      margin: 1vh 0;
      height: 10vh;
      display: flex;
      flex-direction: row;
    }
      #jokers{
        background-color: lightcyan;
        width: 70vw;
      }
      #consumables{
        background-color: honeydew;
        width: 30vw;
      }
    
    #center,#hand{
      height: 23vh;
      }
      #center{
        background-color: lightgreen;
      }
      #hand{
        background-color: lightgoldenrodyellow;
      }
  </style>
  <style id="playButtonStyle">
    #playButtons{
      background-color: lightcoral;
      height: 8vh;
      
      display: flex;
      justify-content: space-evenly;
      align-items: center;
    }
    #playButtons>*{
      height: 7vh;
      
      font-size: 16px;
    }
      #playHand, #discardHand{
        width: 25vw;
      }
      #sortRank, #sortSuit{
        width: 18vw;
      }
      
  </style>
  <style id="cardStyle">
    #jokers>*,#consumables>*,#center>*,#hand>*{
      width: 6.48vh;
      aspect-ratio: 5.76/8;
    }
    #jokers>*{
      background-image: linear-gradient(to bottom right, red, yellow);
    }
    #consumables>*{
      background-image: linear-gradient(to bottom right, green, lightcyan);
    }
    #center>*,#hand>*{
      background-image: linear-gradient(to bottom right, lightgray, ivory);
    }
  </style>

  <script id="onload_and_general_functions_script">
  //GENERAL
    window.addEventListener('load', () => {
      document.addEventListener('touchmove', function(event) {if (event.touches.length > 1) { event.preventDefault();}}, { passive: false });// Disable pinch zoom on the document
      document.addEventListener('dblclick', function(event) { event.preventDefault();});// Disable double click to zoom
        //display stuff
      resize(); 
      window.addEventListener('resize', resize);
      window.addEventListener('deviceorientation', resize);
        //buttons
      //initializeButtons();
    });
    //GENERAL functions
    function resize(){
      screenWidth = window.innerWidth; screenHeight = window.innerHeight;
      resizeTo(screenWidth, screenHeight);
    }
    //const FRAMERATE = 24;
    //function startTimer(){ timer = setInterval(update, 1000/FRAMERATE);}
    function update(){}
  </script>
  <script id="classes_script">
  //CLASSES
    let playerInstant = new Player("name", []);
    const SPADE = 1, HEART = 2, DIAMOND = 3, CLUB = 4;
    const SCORE_TRIGGER=52043, HELD_TRIGGER=4310, HELD_ON_ROUND_END_TRIGGER=4360, DISCARDED_TRIGGER=41524, ROUND_START_TRIGGER=57447;
    //player
    class Player{
      constructor(name, deck){
        this.name = name;
        //round
        this.roundScore = 0;
        this.handScore = 0;
        this.chips = 0;
        this.mult = 0;
        this.hand = [];
        this.played = [];
        this.indexOfLastDrawn = 0;
        //game
        this.hands = 3;
        this.handSize = 7;
        this.discards = 3;
        this.coins = 0;
        this.ante = 1;
        this.jokers = [];
        this.deck = deck;
      }
    }
    
    //card
    class Card{
      constructor(rank, suit, enh, sea, edi){
        this.rank = rank;
        this.suit = suit;
        
        this.enhancement = enh;
        this.edition = edi;
        this.seal = sea;
      }
      //on score effects
      score(){
        //add rank
        runModifiers(SCORE_TRIGGER);
      }
      //retrigger
      checkForNumberOfRetriggers(){
        
      }
      //MODIFIERS
      runModifiers(trigger){
        this.enhancement.attemptExecuteEffect(trigger,playerInstant,this);
        //attempt trigger edition
        //attempt trigger seal
      }
      
    }
    /* MODIFIERS
    Playing cards may each have one Enhancement, one Edition, and one Seal.
    Jokers may have one Edition and multiple Stickers
    Consumable may have the negative Edition (via Perkeo)
    
    Editions are different for cards, jokers, and consumables, but essentially do the same things
    */
    class Enhancement{
      constructor(triggerType, chipAddAmount, multiplierAdd, chipMultiplier, multiplierMultiply, isStoneCard, isWildCard, willBeDestroyed, coinAmountAdd, coinAmountMultiply, chance) {
        this.trigger = triggerType; // see above for triggers, 0 means no trigger (on add)
        
        this.chipAdd = chipAddAmount; // chip add
        this.multAdd = multiplierAdd; // mult add
        this.chipMult = chipMultiplier; // chip multiply
        this.multMult = multiplierMultiply; // mult multiply
        
        this.isStone = isStoneCard;
        this.isWild = isWildCard; // bool
        this.willBeDestroyed = willBeDestroyed; // bool; indicates if the card will be destroyed
        
        this.coinAdd = coinAmountAdd; // amount of coins A
        this.coinMult = coinAmountMultiply; // amount of coins M
        
        this.chance = chance; // chance of the card getting destroyed/triggered
      }
      attemptExecuteEffect(trigger,player,card){
        if(trigger==this.trigger){
          let chanceSuccess = false;
          if(Math.random()<this.chance) chanceSuccess = true;
          if(chanceSuccess || willBeDestroyed){ this.executeEffect(player,card);}
          if(chanceSuccess && willBeDestroyed){ card.destroy();}
        }
      }
      executeEffect(p,c){
        p.chips *= this.coinMultiply;
        p.mult *= this.mm;
        p.chips += this.ca;
        p.mult += this.ma;
        if(sr+re>0){ c.srEffect(se,re);}
        if(isWild){ c.srEffect(isWild);}
        p.coins += this.coina;
        p.coins *= this.coinm;
      }
    }
    
    //instantiation
    if(1==1){
      var ebonus = new Enhancement(SCORE_TRIGGER, 30, 0, 1, 1, false, false, false, 0, 0, 1);
      var emult  = new Enhancement(SCORE_TRIGGER, 0, 4, 1, 1, false, false, false, 0, 0, 1);
      var ewild  = new Enhancement(0, 0, 0, 1, 1, false, true, false, 0, 0, 1);
      var eglass = new Enhancement(SCORE_TRIGGER, 0, 0, 1, 2, false, false, true, 0, 0, 0.25);
      var esteel = new Enhancement(HELD_TRIGGER, 0, 0, 1, 1.5, false, false, false, 0, 0, 1);
      var estone = new Enhancement(0, 50, 0, 0, 0, true, false, false, 0, 0, 1);
      var egold  = new Enhancement(HELD_ON_ROUND_END_TRIGGER, 0, 0, 1, 1, false, false, false, 3, 0, 1);
      var elucky = new Enhancement(SCORE_TRIGGER, 0, 20, 1, 1, false, false, false, 0, 0, 0.2);
    }
    //deck
    class Deck{
      constructor(c){
        this.cards = c;
        this.presentedOrder = c;
      }
      shuffle(){
        let currentIndex = this.cards.length;
      
        while (currentIndex != 0) {
          let randomIndex = Math.floor(Math.random() * currentIndex);
          currentIndex--;
          [this.presentedOrder[currentIndex], this.presentedOrder[randomIndex]] = [
          this.presentedOrder[randomIndex], this.presentedOrder[currentIndex]];
        }
      }
      sort(){
        //idek
      }
      addCard(card){
        this.cards.push(card);
        this.sort();
        this.presentedOrder = this.cards;
        //shuffle?
      }
    }
    //jokers
  </script>
  <script id="game_class_script">
    //game
    const SMALLREWARD = 3, BIGREWARD = 4, BOSSREWARD = 5, FINISHERREWARD = 8;
    const SMALLMULT = 1, BIGMULT = 1.5, BOSSMULT = 2, FINISHERMULT = 2;
    class Game{
      constructor(seed){
        this.baseReq = [100, 300,800,2000,5000, 11000,20000,35000,50000, 110000,560000,7200000,300 000000, 47 000 000 000,29 000000 000000, 77 000000 000 000000, 860 000000 000000 000000];//with ante as the index
        this.blindCount = 0;
        this.currentRoundsBlinds = [];
        this.completedBossBlinds = [];
      }
      startNextRound(player){
        this.blindCount++;
        let smallBlind = new Blind("small blind", player.ante*SMALLMULT, SMALLREWARD, "", );
        let bigBlind = new Blind("big blind", player.ante*BIGMULT, BIGREWARD, "", );
        let bossBlind = createBossBlind();
        
      }
      skipNextBlind(){
        this.blindCount++;
      }
      createBossBlind(){
        //createBossBlind
        //temporary
        return new Blind("bos blind", player.ante*BOSSMULT, BOSSREWARD, "", );
      }
    }
    //round
    class Blind{
      constructor(title, blindReq, blindReward, description, hands, discards) {
        this.title = title;
        this.blindReq = blindReq;
        this.blindReward = blindReward;
        this.description = description;
        this.hands = hands;
        this.discards = discards;
        //player
        this.special; //?
      }
      start(player){
        //shuffle player.deck
        //draw hand with player.deck.presentedOrder, player.handSize, 
        
        //if(this.isBoss) attemptExecuteBossBlindEffect(ROUND_START_TRIGGER)
        
        //
      }
      end(){
        //for each card in hand.attemptExecuteEffect(HELD_ON_ROUND_END_TRIGGER);
        //put away all cards (not discard)
      }
    }

    var standard52 = new Deck([
      
    ]);
    var user = new Player("test", standard52);
  </script>
  <script>
    //DISPLAYS
  if(1==1){
    //cards
    //jokers
  }
  
    //BUTTONS
  if(1==0){
    var lb = document.getElementById("lb");
    var ub = document.getElementById("ub");
    var rb = document.getElementById("rb");
    var db = document.getElementById("db");
    var a = document.getElementById("a");
    var b = document.getElementById("b");
    function initializeButtons(){
      buttons = [lb, ub, rb, db, a, b];
      buttons.forEach(button => {
        button.addEventListener('touchstart', executeButtonEffect);
        button.innerHTML = "._.<br>i"+button.id.charAt(0)+"i<br>._.";
      })
    }
    function executeButtonEffect(){
      const buttonId = event.target.id;
      console.log(`Button pressed: ${buttonId}`);
    }
  }
  </script>
</html>
